# ISS_data_analysis_project
## About the repository
This repository content 4 files for the project
 - app.py: this python file read in the data from the ISS data files downloaded from the website and analyze the data to output different data with user choice
 - pytest_app.py: this python file test the minimum functionalliy of the functions in app.py file
 - Makefile: this file create and build the docker image to the Dockerhub, and run the Dockerfile
 - Dockerfile: this file pull and run the image from the Dockerhub

## Introduction
In this project, we analyze the data of the best estimated real-time trajectory and local sightings opportunities for the International Space Station (ISS) as generated by the Trajectory Operations and Planning (TOPO) flight controllers at Johnson Space Center. To analyze the data, we collect the data from the Public Distribution File and the XMLsightingData_citiesINT02 file by reading in the files to our flask web application. After we analyze the data with the flask app, we run the Makefile with the Dockerfile to containerize the app into a Docker image and push it to the Dockerhub so other users can access and run the app through a terminal window. In this project, we use the skills and knowledge of Docker imaging system, XML data file analysis, and flask app; these help us practice and learn the knowledge better.

## Procedure
1. To get started with the project, we need to download the data files from this website [Link](https://data.nasa.gov/Space-Science/ISS_COORDS_2022-02-13/r6u8-bhhq). The first ISS.OEM_J2K_EPH file can be found in the first one of the file options under the **Public Distribution File** and click on the **XML** to download the file with XML file format. Similar steps for the XMLsightingData_citiesINT02 file, find the line that's under **XMLsightingData_citiesINT02** and click on **XML** to get the XML data file. 
To run the project, we run the **Makefile** with the code `make all`, this code run and build the docker file. before run `make all`, please chage the first line of the code in the **Makefile**
```
NAME ?= your dockerhub username
```
replace your dockerhub username to where *your dockerhub username*.
2. After the Makefile is ran, the Dockerfile would be run together within the `docker build` code in the Makefile which creates the docker image of **app.py** and creates a flask server for the docker image.
3. Everything is setup after step 1 and 2 above, than run the code `curl localhost:5034/` to get an instruction of how to interact with the application. 
### Expected output:
```
Download the data to file with code curl localhost:<your port number>/download -X POST
 Then interact the function with code curl localhost:<your port number>/<option of the data user want to get>
The options of the datas are:
position/Epochs -- all Epochs in the position data
position/<Epoch name> -- all information about a specific Epoch in the positional data
Country/Countries -- all countries from the sighting data
Country/<Country name> -- all information about a specific Country in the sighting data
Country/<country_name>/Region/Regions -- all regions associated with a given Country in the sighting data
Country/<country_name>/Region/<region_name> -- all information about a specific Region in the sighting data
Country/<country_name>/Region/<region_name>/City/Cities -- all cities associated with a given Country and Region in the sighting data
Country/<country_name>/Region/<region_name>/City/<city_name> -- all information about a specific City in the sighting data
```
4. Based on the options above, you neeed to run the code `curl localhost:<your port number>/download -X POST`, in this case the port number would be *5034* same as what's in the Makefile. The expected output of the code would be `Download Completed` if it ran successfully. 
5. The options in step 3 are the routes to get different datas in the XML files. For example, the code `curl localhost:5034/Country/Countries` would output all the countries listed in the XMLsightingData_citiesINT02 file as a dict type output variable.
### Expected output:
```
{
  "Countries": [
    "Canada",
    "Chile",
    "China",
    "Colombia",
    "Comoros",
    "Costa_Rica",
    "Croatia",
    "Cuba",
    "Curacao",
    "Cyprus",
    "Czech_Republic",
    "Denmark",
    "Dominica",
    "Dominican_Republic",
    "Ecuador",
    "Egypt",
    "El_Salvador",
    "Estonia",
    "Ethiopia",
    "Falkland_Islands",
    "Fiji",
    "Finland",
    "France",
    "French_Guiana",
    "Gabon",
    "Gambia",
    "Georgia",
    "Germany"
  ]
}
```

## Logging
The logging message is used in the read function in the app.py file and output an **error message** when wrong filename or file is not found. 

## Docker image
1. In the Makefile, the docker image is build with `docker image build -t ${NAME}/app:1.0 .` code 
2. The docker image build in step 1 is pull to the Dockerhub with `docker pull ${NAME}/app:1.0` code
3. After the docker image is in the Dockerhub, the docker image can be get by pull the docker image from Dockerhub with code `docker pull <your docker username>/app:1.0` 
4. After the docker image pulled, the docker image can be run by code docker run --name "ISS_position_and_sighting_data_analysis_project" -d -p 5023:5000 <your Dockerhub username>/app:1.0`
5. At the end, to stop running the docker image with code `docker container stop ISS_position_and_sighting_data_analysis_project` and to free the space with code `docker container rm ISS_position_and_sighting_data_analysis_project` which will stop and remove the container

## Unite test
The pytest/-app.py file is run with code `pytest pytest_app.py`. The expected ouput would be `3 passed` and the end which result the successful test ran with no error in the function of app.py file.
 
## Citation
**Abstract:** The datas used in this project are downloaded from the NASA's Open Data Portal
 - Publisher:	TOPO
 - Contact Name:	Scott Goodwin
 - Contact Email:	scott.goodwin@nasa.gov
 - Bureau Code:	026:00
 - Program Code:	026:004
 - Temporal Applicability:	2022-02-13T00:00:00Z/P1D
 - Is Quality Data:	true
 - Language:	en-US
 - Homepage:	https://spotthestation.nasa.gov
 - Issued:	2022-02-13
 - License:	http://www.usa.gov/publicdomain/label/1.0/
 - Unique Identifier:	nasa-iss-data_2022-02-13
